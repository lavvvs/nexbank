{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lavan/Downloads/banking-web-application/lib/mongodb.ts"],"sourcesContent":["// lib/mongodb.ts\r\nimport mongoose from \"mongoose\";\r\n\r\nconst MONGO_URI = process.env.DATABASE_URL!;\r\nif (!MONGO_URI) throw new Error(\"Please define DATABASE_URL in your .env\");\r\n\r\n// Cache the connection across hot reloads (Next.js)\r\nlet cached = (global as any).mongoose;\r\n\r\nif (!cached) {\r\n  cached = (global as any).mongoose = { conn: null, promise: null };\r\n}\r\n\r\nasync function dbConnect() {\r\n  if (cached.conn) return cached.conn;\r\n\r\n  if (!cached.promise) {\r\n    cached.promise = mongoose.connect(MONGO_URI).then((mongoose) => mongoose);\r\n  }\r\n  cached.conn = await cached.promise;\r\n  return cached.conn;\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":"AAAA,iBAAiB;;;;;AACjB;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,YAAY;AAC1C,IAAI,CAAC,WAAW,MAAM,IAAI,MAAM;AAEhC,oDAAoD;AACpD,IAAI,SAAS,yDAAgB,QAAQ;AAErC,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAgB,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AAClE;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE,OAAO,OAAO,IAAI;IAEnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,WAAW,IAAI,CAAC,CAAC,WAAa;IAClE;IACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lavan/Downloads/banking-web-application/lib/models.ts"],"sourcesContent":["// lib/models.ts\r\nimport mongoose, { Schema, Document } from \"mongoose\";\r\n\r\nconst { ObjectId } = Schema.Types;\r\n\r\n// =======================\r\n// 1️⃣ Profile\r\n// =======================\r\nexport interface IProfile extends Document {\r\n  clerkId: string; // Changed: Add clerkId as the primary identifier\r\n  email: string;\r\n  fullName?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  kycStatus: string;\r\n  isAdmin: boolean;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst ProfileSchema = new Schema<IProfile>(\r\n  {\r\n    clerkId: { type: String, unique: true, required: true }, // Changed: Use Clerk ID\r\n    email: { type: String, unique: true, required: true },\r\n    fullName: String,\r\n    phone: String,\r\n    address: String,\r\n    kycStatus: { type: String, default: \"pending\" },\r\n    isAdmin: { type: Boolean, default: false },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\n// =======================\r\n// 2️⃣ Account\r\n// =======================\r\nexport interface IAccount extends Document {\r\n  userId: string; // Changed: String instead of ObjectId\r\n  accountNumber: string;\r\n  accountType: string;\r\n  balance: number;\r\n  currency: string;\r\n  status: string;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst AccountSchema = new Schema<IAccount>(\r\n  {\r\n    userId: { type: String, required: true }, // Changed: String for Clerk ID\r\n    accountNumber: { type: String, unique: true, required: true },\r\n    accountType: String,\r\n    balance: { type: Number, default: 0 },\r\n    currency: { type: String, default: \"USD\" },\r\n    status: { type: String, default: \"active\" },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\n// =======================\r\n// 3️⃣ Transaction\r\n// =======================\r\nexport interface ITransaction extends Document {\r\n  userId: string; // Changed: String instead of ObjectId\r\n  accountId: mongoose.Types.ObjectId;\r\n  amount: number;\r\n  type: string;\r\n  status: string;\r\n  description?: string;\r\n  referenceId?: string;\r\n  recipientAccountId?: mongoose.Types.ObjectId;\r\n  recipientUserId?: string; // Changed: String instead of ObjectId\r\n  createdAt: Date;\r\n}\r\n\r\nconst TransactionSchema = new Schema<ITransaction>(\r\n  {\r\n    userId: { type: String, required: true }, // Changed: String for Clerk ID\r\n    accountId: { type: ObjectId, ref: \"Account\", required: true },\r\n    amount: { type: Number, required: true },\r\n    type: { type: String, required: true },\r\n    status: { type: String, default: \"completed\" },\r\n    description: String,\r\n    referenceId: String,\r\n    recipientAccountId: { type: ObjectId, ref: \"Account\" },\r\n    recipientUserId: { type: String }, // Changed: String for Clerk ID\r\n  },\r\n  { timestamps: { createdAt: true, updatedAt: false } }\r\n);\r\n\r\n// =======================\r\n// 4️⃣ Loan\r\n// =======================\r\nexport interface ILoan extends Document {\r\n  userId: string; // Changed: String instead of ObjectId\r\n  loanType: string;\r\n  amount: number;\r\n  interestRate: number;\r\n  tenureMonths: number;\r\n  emiAmount: number;\r\n  totalPayable: number;\r\n  amountPaid: number;\r\n  remainingAmount?: number;\r\n  status: string;\r\n  disbursementAccountId?: mongoose.Types.ObjectId;\r\n  approvedBy?: string; // Changed: String instead of ObjectId\r\n  approvedAt?: Date;\r\n  disbursedAt?: Date;\r\n  nextEmiDate?: Date;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nconst LoanSchema = new Schema<ILoan>(\r\n  {\r\n    userId: { type: String, required: true }, // Changed: String for Clerk ID\r\n    loanType: String,\r\n    amount: Number,\r\n    interestRate: Number,\r\n    tenureMonths: Number,\r\n    emiAmount: Number,\r\n    totalPayable: Number,\r\n    amountPaid: { type: Number, default: 0 },\r\n    remainingAmount: Number,\r\n    status: { type: String, default: \"pending\" },\r\n    disbursementAccountId: { type: ObjectId, ref: \"Account\" },\r\n    approvedBy: { type: String }, // Changed: String for Clerk ID\r\n    approvedAt: Date,\r\n    disbursedAt: Date,\r\n    nextEmiDate: Date,\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\n// =======================\r\n// 5️⃣ EmiPayment\r\n// =======================\r\nexport interface IEmiPayment extends Document {\r\n  loanId: mongoose.Types.ObjectId;\r\n  userId: string; // Changed: String instead of ObjectId\r\n  emiNumber: number;\r\n  amount: number;\r\n  principalAmount: number;\r\n  interestAmount: number;\r\n  dueDate: Date;\r\n  paidDate?: Date;\r\n  status: string;\r\n  stripePaymentId?: string;\r\n  transactionId?: mongoose.Types.ObjectId;\r\n  createdAt: Date;\r\n}\r\n\r\nconst EmiPaymentSchema = new Schema<IEmiPayment>(\r\n  {\r\n    loanId: { type: ObjectId, ref: \"Loan\", required: true },\r\n    userId: { type: String, required: true, index: true }, // Changed: String for Clerk ID\r\n    emiNumber: Number,\r\n    amount: Number,\r\n    principalAmount: Number,\r\n    interestAmount: Number,\r\n    dueDate: Date,\r\n    paidDate: Date,\r\n    status: { type: String, default: \"pending\" },\r\n    stripePaymentId: String,\r\n    transactionId: { type: ObjectId, ref: \"Transaction\" },\r\n  },\r\n  { timestamps: { createdAt: true, updatedAt: false } }\r\n);\r\n\r\n// =======================\r\n// 6️⃣ BankSetting\r\n// =======================\r\nexport interface IBankSetting extends Document {\r\n  settingKey: string;\r\n  settingValue: string;\r\n  description?: string;\r\n  updatedBy?: string; // Changed: String instead of ObjectId\r\n  updatedAt: Date;\r\n}\r\n\r\nconst BankSettingSchema = new Schema<IBankSetting>(\r\n  {\r\n    settingKey: { type: String, unique: true },\r\n    settingValue: String,\r\n    description: String,\r\n    updatedBy: { type: String }, // Changed: String for Clerk ID\r\n  },\r\n  { timestamps: { createdAt: false, updatedAt: true } }\r\n);\r\n\r\n// =======================\r\n// Export all models\r\n// =======================\r\nexport const Profile =\r\n  mongoose.models.Profile || mongoose.model(\"Profile\", ProfileSchema);\r\nexport const Account =\r\n  mongoose.models.Account || mongoose.model(\"Account\", AccountSchema);\r\nexport const Transaction =\r\n  mongoose.models.Transaction ||\r\n  mongoose.model(\"Transaction\", TransactionSchema);\r\nexport const Loan = mongoose.models.Loan || mongoose.model(\"Loan\", LoanSchema);\r\nexport const EmiPayment =\r\n  mongoose.models.EmiPayment || mongoose.model(\"EmiPayment\", EmiPaymentSchema);\r\nexport const BankSetting =\r\n  mongoose.models.BankSetting ||\r\n  mongoose.model(\"BankSetting\", BankSettingSchema);\r\n\r\n// lib/models.ts (add this to your existing models file)\r\n\r\nconst bankSettingsSchema = new mongoose.Schema(\r\n  {\r\n    userId: {\r\n      type: String,\r\n      required: true,\r\n      unique: true,\r\n      index: true,\r\n    },\r\n    bankName: {\r\n      type: String,\r\n      default: \"Your Bank\",\r\n    },\r\n    transactionLimits: {\r\n      daily: {\r\n        type: Number,\r\n        default: 10000,\r\n      },\r\n      perTransaction: {\r\n        type: Number,\r\n        default: 5000,\r\n      },\r\n    },\r\n    interestRates: {\r\n      savings: {\r\n        type: Number,\r\n        default: 3.5,\r\n      },\r\n      checking: {\r\n        type: Number,\r\n        default: 0.5,\r\n      },\r\n    },\r\n    fees: {\r\n      monthlyMaintenance: {\r\n        type: Number,\r\n        default: 0,\r\n      },\r\n      overdraft: {\r\n        type: Number,\r\n        default: 35,\r\n      },\r\n      atmWithdrawal: {\r\n        type: Number,\r\n        default: 2.5,\r\n      },\r\n    },\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nexport const BankSettings =\r\n  mongoose.models.BankSettings ||\r\n  mongoose.model(\"BankSettings\", bankSettingsSchema);\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lavan/Downloads/banking-web-application/app/api/loans/pay-emi/route.ts"],"sourcesContent":["// app/api/loans/pay-emi/route.ts\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport dbConnect from \"@/lib/mongodb\";\r\nimport { Loan, EmiPayment, Account, Transaction } from \"@/lib/models\";\r\nimport mongoose from \"mongoose\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { userId } = await auth();\r\n\r\n    if (!userId) {\r\n      return NextResponse.json(\r\n        { success: false, error: \"Unauthorized\" },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { loanId, emiId, accountId } = body;\r\n\r\n    // Validate input\r\n    if (!loanId || !emiId || !accountId) {\r\n      return NextResponse.json(\r\n        { success: false, error: \"Missing required fields\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    await dbConnect();\r\n\r\n    // Start a session for transaction\r\n    const session = await mongoose.startSession();\r\n    session.startTransaction();\r\n\r\n    try {\r\n      // 1. Find and validate the EMI payment\r\n      const emiPayment = await EmiPayment.findById(emiId).session(session);\r\n      if (!emiPayment) {\r\n        throw new Error(\"EMI payment not found\");\r\n      }\r\n\r\n      if (emiPayment.status === \"paid\") {\r\n        throw new Error(\"This EMI has already been paid\");\r\n      }\r\n\r\n      // 2. Find and validate the loan\r\n      const loan = await Loan.findById(loanId).session(session);\r\n      if (!loan) {\r\n        throw new Error(\"Loan not found\");\r\n      }\r\n\r\n      if (loan.userId !== userId) {\r\n        throw new Error(\"Unauthorized: This loan doesn't belong to you\");\r\n      }\r\n\r\n      // 3. Find and validate the account\r\n      const account = await Account.findById(accountId).session(session);\r\n      if (!account) {\r\n        throw new Error(\"Account not found\");\r\n      }\r\n\r\n      if (account.userId !== userId) {\r\n        throw new Error(\"Unauthorized: This account doesn't belong to you\");\r\n      }\r\n\r\n      if (account.status !== \"active\") {\r\n        throw new Error(\"Account is not active\");\r\n      }\r\n\r\n      // 4. Check sufficient balance\r\n      if (account.balance < emiPayment.amount) {\r\n        throw new Error(\r\n          `Insufficient balance. Required: ${emiPayment.amount.toFixed(\r\n            2\r\n          )}, Available: ${account.balance.toFixed(2)}`\r\n        );\r\n      }\r\n\r\n      // 5. Deduct amount from user account\r\n      account.balance -= emiPayment.amount;\r\n      await account.save({ session });\r\n\r\n      // 6. Add amount to admin account (for tracking)\r\n      const adminAccount = await Account.findOne({\r\n        accountType: \"admin\",\r\n      }).session(session);\r\n\r\n      if (adminAccount) {\r\n        adminAccount.balance += emiPayment.amount;\r\n        await adminAccount.save({ session });\r\n      }\r\n\r\n      // 7. Update EMI payment status\r\n      emiPayment.status = \"paid\";\r\n      emiPayment.paidDate = new Date();\r\n      await emiPayment.save({ session });\r\n\r\n      // 8. Update loan amounts\r\n      loan.amountPaid = (loan.amountPaid || 0) + emiPayment.amount;\r\n      loan.remainingAmount = Math.max(\r\n        0,\r\n        loan.remainingAmount - emiPayment.amount\r\n      );\r\n\r\n      // Update next EMI date\r\n      const nextPendingEmi = await EmiPayment.findOne({\r\n        loanId: loan._id,\r\n        status: \"pending\",\r\n      })\r\n        .sort({ emiNumber: 1 })\r\n        .session(session);\r\n\r\n      if (nextPendingEmi) {\r\n        loan.nextEmiDate = nextPendingEmi.dueDate;\r\n      } else {\r\n        // All EMIs are paid, mark loan as completed\r\n        loan.status = \"completed\";\r\n        loan.nextEmiDate = undefined;\r\n      }\r\n\r\n      await loan.save({ session });\r\n\r\n      // 9. Create transaction record - THIS IS THE KEY PART\r\n      const transaction = new Transaction({\r\n        userId: userId, // ✅ Clerk user ID\r\n        accountId: account._id,\r\n        type: \"emi_payment\", // ✅ Correct type\r\n        amount: emiPayment.amount,\r\n        status: \"completed\",\r\n        description: `EMI #${emiPayment.emiNumber} payment for ${loan.loanType} loan`,\r\n        referenceId: loanId, // ✅ Link to loan (if this field exists in your schema)\r\n      });\r\n\r\n      await transaction.save({ session });\r\n\r\n      console.log(\"✅ EMI Transaction Created:\", {\r\n        id: transaction._id.toString(),\r\n        userId: transaction.userId,\r\n        accountId: transaction.accountId.toString(),\r\n        type: transaction.type,\r\n        amount: transaction.amount,\r\n        description: transaction.description,\r\n      });\r\n\r\n      // Update EMI payment with transaction reference\r\n      emiPayment.transactionId = transaction._id;\r\n      await emiPayment.save({ session });\r\n\r\n      // Commit the transaction\r\n      await session.commitTransaction();\r\n\r\n      console.log(\r\n        `✅ EMI #${emiPayment.emiNumber} paid successfully for loan ${loanId}`\r\n      );\r\n\r\n      // Revalidate paths\r\n      revalidatePath(\"/dashboard/loans\");\r\n      revalidatePath(\"/dashboard/transactions\");\r\n      revalidatePath(\"/dashboard/accounts\");\r\n      revalidatePath(\"/admin/transactions\");\r\n\r\n      return NextResponse.json({\r\n        success: true,\r\n        message: \"EMI payment successful\",\r\n        data: {\r\n          emiNumber: emiPayment.emiNumber,\r\n          amountPaid: emiPayment.amount,\r\n          newBalance: account.balance,\r\n          remainingAmount: loan.remainingAmount,\r\n          nextEmiDate: loan.nextEmiDate,\r\n          loanStatus: loan.status,\r\n          transactionId: transaction._id,\r\n        },\r\n      });\r\n    } catch (error) {\r\n      // Rollback transaction on error\r\n      await session.abortTransaction();\r\n      throw error;\r\n    } finally {\r\n      session.endSession();\r\n    }\r\n  } catch (error: any) {\r\n    console.error(\"❌ EMI payment error:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        success: false,\r\n        error: error.message || \"Failed to process EMI payment\",\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}