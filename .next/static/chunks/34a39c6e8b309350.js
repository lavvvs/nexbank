(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87336,e=>{"use strict";var t=e.i(93791),r=e.i(75305),a=e.i(21463),n=e.i(95264),s="Progress",[i,l]=(0,a.createContextScope)(s),[o,d]=i(s),c=r.forwardRef((e,r)=>{var a,s;let{__scopeProgress:i,value:l=null,max:d,getValueLabel:c=x,...u}=e;(d||0===d)&&!f(d)&&console.error((a=`${d}`,`Invalid prop \`max\` of value \`${a}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let m=f(d)?d:100;null===l||g(l,m)||console.error((s=`${l}`,`Invalid prop \`value\` of value \`${s}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let v=g(l,m)?l:null,b=p(v)?c(v,m):void 0;return(0,t.jsx)(o,{scope:i,value:v,max:m,children:(0,t.jsx)(n.Primitive.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":p(v)?v:void 0,"aria-valuetext":b,role:"progressbar","data-state":h(v,m),"data-value":v??void 0,"data-max":m,...u,ref:r})})});c.displayName=s;var u="ProgressIndicator",m=r.forwardRef((e,r)=>{let{__scopeProgress:a,...s}=e,i=d(u,a);return(0,t.jsx)(n.Primitive.div,{"data-state":h(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...s,ref:r})});function x(e,t){return`${Math.round(e/t*100)}%`}function h(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function p(e){return"number"==typeof e}function f(e){return p(e)&&!isNaN(e)&&e>0}function g(e,t){return p(e)&&!isNaN(e)&&e<=t&&e>=0}m.displayName=u;var v=e.i(47163);function b({className:e,value:r,...a}){return(0,t.jsx)(c,{"data-slot":"progress",className:(0,v.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...a,children:(0,t.jsx)(m,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})})}e.s(["Progress",()=>b],87336)},41350,e=>{"use strict";var t=e.i(93791),r=e.i(75305),a=e.i(30499),n=e.i(67881),s=e.i(30374),i=e.i(62870),l=e.i(23750),o=e.i(10708),d=e.i(36102),c=e.i(78896),u=e.i(69136),m=e.i(21463),x=e.i(45081),h=e.i(37777),p=e.i(54857),f=e.i(8444),g=e.i(95264),v=e.i(14503),b=["PageUp","PageDown"],j=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],y={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},w="Slider",[N,S,D]=(0,v.createCollection)(w),[C,P]=(0,m.createContextScope)(w,[D]),[M,A]=C(w),L=r.forwardRef((e,a)=>{let{name:n,min:s=0,max:i=100,step:l=1,orientation:o="horizontal",disabled:u=!1,minStepsBetweenThumbs:m=0,defaultValue:h=[s],value:p,onValueChange:f=()=>{},onValueCommit:g=()=>{},inverted:v=!1,form:y,...w}=e,S=r.useRef(new Set),D=r.useRef(0),C="horizontal"===o,[P=[],A]=(0,x.useControllableState)({prop:p,defaultProp:h,onChange:e=>{let t=[...S.current];t[D.current]?.focus(),f(e)}}),L=r.useRef(P);function I(e,t,{commit:r}={commit:!1}){let a,n=(String(l).split(".")[1]||"").length,o=Math.round((Math.round((e-s)/l)*l+s)*(a=Math.pow(10,n)))/a,c=(0,d.clamp)(o,[s,i]);A((e=[])=>{let a=function(e=[],t,r){let a=[...e];return a[r]=t,a.sort((e,t)=>e-t)}(e,c,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,r)=>e[r+1]-t))>=t;return!0}(a,m*l))return e;{D.current=a.indexOf(c);let t=String(a)!==String(e);return t&&r&&g(a),t?a:e}})}return(0,t.jsx)(M,{scope:e.__scopeSlider,name:n,disabled:u,min:s,max:i,valueIndexToChangeRef:D,thumbs:S.current,values:P,orientation:o,form:y,children:(0,t.jsx)(N.Provider,{scope:e.__scopeSlider,children:(0,t.jsx)(N.Slot,{scope:e.__scopeSlider,children:(0,t.jsx)(C?k:R,{"aria-disabled":u,"data-disabled":u?"":void 0,...w,ref:a,onPointerDown:(0,c.composeEventHandlers)(w.onPointerDown,()=>{u||(L.current=P)}),min:s,max:i,inverted:v,onSlideStart:u?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let r=e.map(e=>Math.abs(e-t)),a=Math.min(...r);return r.indexOf(a)}(P,e);I(e,t)},onSlideMove:u?void 0:function(e){I(e,D.current)},onSlideEnd:u?void 0:function(){let e=L.current[D.current];P[D.current]!==e&&g(P)},onHomeKeyDown:()=>!u&&I(s,0,{commit:!0}),onEndKeyDown:()=>!u&&I(i,P.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!u){let r=b.includes(e.key)||e.shiftKey&&j.includes(e.key),a=D.current;I(P[a]+l*(r?10:1)*t,a,{commit:!0})}}})})})})});L.displayName=w;var[I,E]=C(w,{startEdge:"left",endEdge:"right",size:"width",direction:1}),k=r.forwardRef((e,a)=>{let{min:n,max:s,dir:i,inverted:l,onSlideStart:o,onSlideMove:d,onSlideEnd:c,onStepKeyDown:m,...x}=e,[p,f]=r.useState(null),g=(0,u.useComposedRefs)(a,e=>f(e)),v=r.useRef(void 0),b=(0,h.useDirection)(i),j="ltr"===b,w=j&&!l||!j&&l;function N(e){let t=v.current||p.getBoundingClientRect(),r=K([0,t.width],w?[n,s]:[s,n]);return v.current=t,r(e-t.left)}return(0,t.jsx)(I,{scope:e.__scopeSlider,startEdge:w?"left":"right",endEdge:w?"right":"left",direction:w?1:-1,size:"width",children:(0,t.jsx)(U,{dir:b,"data-orientation":"horizontal",...x,ref:g,style:{...x.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=N(e.clientX);o?.(t)},onSlideMove:e=>{let t=N(e.clientX);d?.(t)},onSlideEnd:()=>{v.current=void 0,c?.()},onStepKeyDown:e=>{let t=y[w?"from-left":"from-right"].includes(e.key);m?.({event:e,direction:t?-1:1})}})})}),R=r.forwardRef((e,a)=>{let{min:n,max:s,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:d,onStepKeyDown:c,...m}=e,x=r.useRef(null),h=(0,u.useComposedRefs)(a,x),p=r.useRef(void 0),f=!i;function g(e){let t=p.current||x.current.getBoundingClientRect(),r=K([0,t.height],f?[s,n]:[n,s]);return p.current=t,r(e-t.top)}return(0,t.jsx)(I,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:(0,t.jsx)(U,{"data-orientation":"vertical",...m,ref:h,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=g(e.clientY);l?.(t)},onSlideMove:e=>{let t=g(e.clientY);o?.(t)},onSlideEnd:()=>{p.current=void 0,d?.()},onStepKeyDown:e=>{let t=y[f?"from-bottom":"from-top"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),U=r.forwardRef((e,r)=>{let{__scopeSlider:a,onSlideStart:n,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:d,...u}=e,m=A(w,a);return(0,t.jsx)(g.Primitive.span,{...u,ref:r,onKeyDown:(0,c.composeEventHandlers)(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(o(e),e.preventDefault()):b.concat(j).includes(e.key)&&(d(e),e.preventDefault())}),onPointerDown:(0,c.composeEventHandlers)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),m.thumbs.has(t)?t.focus():n(e)}),onPointerMove:(0,c.composeEventHandlers)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&s(e)}),onPointerUp:(0,c.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),T="SliderTrack",$=r.forwardRef((e,r)=>{let{__scopeSlider:a,...n}=e,s=A(T,a);return(0,t.jsx)(g.Primitive.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:r})});$.displayName=T;var z="SliderRange",H=r.forwardRef((e,a)=>{let{__scopeSlider:n,...s}=e,i=A(z,n),l=E(z,n),o=r.useRef(null),d=(0,u.useComposedRefs)(a,o),c=i.values.length,m=i.values.map(e=>O(e,i.min,i.max)),x=c>1?Math.min(...m):0,h=100-Math.max(...m);return(0,t.jsx)(g.Primitive.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...s,ref:d,style:{...e.style,[l.startEdge]:x+"%",[l.endEdge]:h+"%"}})});H.displayName=z;var _="SliderThumb",V=r.forwardRef((e,a)=>{let n=S(e.__scopeSlider),[s,i]=r.useState(null),l=(0,u.useComposedRefs)(a,e=>i(e)),o=r.useMemo(()=>s?n().findIndex(e=>e.ref.current===s):-1,[n,s]);return(0,t.jsx)(B,{...e,ref:l,index:o})}),B=r.forwardRef((e,a)=>{var n,s,i,l,o;let d,m,{__scopeSlider:x,index:h,name:p,...v}=e,b=A(_,x),j=E(_,x),[y,w]=r.useState(null),S=(0,u.useComposedRefs)(a,e=>w(e)),D=!y||b.form||!!y.closest("form"),C=(0,f.useSize)(y),P=b.values[h],M=void 0===P?0:O(P,b.min,b.max),L=(n=h,(s=b.values.length)>2?`Value ${n+1} of ${s}`:2===s?["Minimum","Maximum"][n]:void 0),I=C?.[j.size],k=I?(i=I,l=M,o=j.direction,m=K([0,50],[0,d=i/2]),(d-m(l)*o)*o):0;return r.useEffect(()=>{if(y)return b.thumbs.add(y),()=>{b.thumbs.delete(y)}},[y,b.thumbs]),(0,t.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[j.startEdge]:`calc(${M}% + ${k}px)`},children:[(0,t.jsx)(N.ItemSlot,{scope:e.__scopeSlider,children:(0,t.jsx)(g.Primitive.span,{role:"slider","aria-label":e["aria-label"]||L,"aria-valuemin":b.min,"aria-valuenow":P,"aria-valuemax":b.max,"aria-orientation":b.orientation,"data-orientation":b.orientation,"data-disabled":b.disabled?"":void 0,tabIndex:b.disabled?void 0:0,...v,ref:S,style:void 0===P?{display:"none"}:e.style,onFocus:(0,c.composeEventHandlers)(e.onFocus,()=>{b.valueIndexToChangeRef.current=h})})}),D&&(0,t.jsx)(F,{name:p??(b.name?b.name+(b.values.length>1?"[]":""):void 0),form:b.form,value:P},h)]})});V.displayName=_;var F=e=>{let{value:a,...n}=e,s=r.useRef(null),i=(0,p.usePrevious)(a);return r.useEffect(()=>{let e=s.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(i!==a&&t){let r=new Event("input",{bubbles:!0});t.call(e,a),e.dispatchEvent(r)}},[i,a]),(0,t.jsx)("input",{style:{display:"none"},...n,ref:s,defaultValue:a})};function O(e,t,r){return(0,d.clamp)(100/(r-t)*(e-t),[0,100])}function K(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(r-e[0])}}var Y=e.i(47163);function X({className:e,defaultValue:a,value:n,min:s=0,max:i=100,...l}){let o=r.useMemo(()=>Array.isArray(n)?n:Array.isArray(a)?a:[s,i],[n,a,s,i]);return(0,t.jsxs)(L,{"data-slot":"slider",defaultValue:a,value:n,min:s,max:i,className:(0,Y.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...l,children:[(0,t.jsx)($,{"data-slot":"slider-track",className:(0,Y.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,t.jsx)(H,{"data-slot":"slider-range",className:(0,Y.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:o.length},(e,r)=>(0,t.jsx)(V,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},r))]})}var q=e.i(70065),W=e.i(19317),G=e.i(29439),J=e.i(90768);let Q=(0,e.i(10965).default)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var Z=e.i(91641),ee=e.i(31368);let et=[{value:"personal",label:"Personal Loan",icon:"ðŸ’°"},{value:"home",label:"Home Loan",icon:"ðŸ "},{value:"education",label:"Education Loan",icon:"ðŸŽ“"},{value:"vehicle",label:"Vehicle Loan",icon:"ðŸš—"},{value:"business",label:"Business Loan",icon:"ðŸ’¼"}];function er({accounts:e,interestRates:d}){let[c,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[f,g]=(0,r.useState)([12]),[v,b]=(0,r.useState)(""),[j,y]=(0,r.useState)(!1),[w,N]=(0,r.useState)(null),S=(0,a.useRouter)(),{user:D}=(0,Z.useUser)(),C=m?d[m]||12:0,P=Number.parseFloat(h)||0,M=f[0],A=P>0?(0,W.calculateEMI)(P,C,M):0,L=A*M,I=L-P,E=()=>{x(""),p(""),g([12]),b(""),N(null)},k=async()=>{if(!m||!h||!v)return void N("Please fill in all required fields");if(P<1e3)return void N("Minimum loan amount is $1,000");if(!D)return void N("You must be logged in");y(!0),N(null);try{await ee.default.post("/api/loans",{userId:D.id,loanType:m,amount:P,interestRate:C,tenureMonths:M,emiAmount:A,totalPayable:L,remainingAmount:L,status:"pending",disbursementAccountId:v}),u(!1),E(),S.refresh()}catch(e){N(e.response?.data?.error||"Something went wrong")}finally{y(!1)}};return(0,t.jsxs)(s.Dialog,{open:c,onOpenChange:e=>{u(e),e||E()},children:[(0,t.jsx)(s.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(n.Button,{children:[(0,t.jsx)(G.Plus,{className:"mr-2 h-4 w-4"}),"Apply for Loan"]})}),(0,t.jsxs)(s.DialogContent,{className:"sm:max-w-lg max-h-[90vh] flex flex-col",children:[(0,t.jsxs)(s.DialogHeader,{children:[(0,t.jsx)(s.DialogTitle,{children:"Apply for a Loan"}),(0,t.jsx)(s.DialogDescription,{children:"Fill in the details to submit your loan application."})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto pr-2",children:(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{children:"Loan Type"}),(0,t.jsxs)(i.Select,{value:m,onValueChange:x,children:[(0,t.jsx)(i.SelectTrigger,{children:(0,t.jsx)(i.SelectValue,{placeholder:"Select loan type"})}),(0,t.jsx)(i.SelectContent,{children:et.map(e=>(0,t.jsx)(i.SelectItem,{value:e.value,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{children:e.label}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["@ ",d[e.value]||12,"% p.a."]})]})},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{children:"Loan Amount (USD)"}),(0,t.jsx)(l.Input,{type:"number",placeholder:"Minimum $1,000",value:h,onChange:e=>p(e.target.value),min:1e3,step:100})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(o.Label,{children:"Tenure"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:[M," months"]})]}),(0,t.jsx)(X,{value:f,onValueChange:g,min:6,max:60,step:6,className:"py-2"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:"6 months"}),(0,t.jsx)("span",{children:"60 months"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{children:"Disbursement Account"}),(0,t.jsxs)(i.Select,{value:v,onValueChange:b,children:[(0,t.jsx)(i.SelectTrigger,{children:(0,t.jsx)(i.SelectValue,{placeholder:"Select account"})}),(0,t.jsx)(i.SelectContent,{children:e.map(e=>(0,t.jsx)(i.SelectItem,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"capitalize",children:e.accountType}),(0,t.jsx)("span",{className:"font-mono text-xs text-muted-foreground",children:e.accountNumber})]})},e.id))})]})]}),P>0&&m&&(0,t.jsx)(q.Card,{className:"border-0 bg-muted/50",children:(0,t.jsxs)(q.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground mb-3",children:[(0,t.jsx)(Q,{className:"h-4 w-4"}),"Loan Summary"]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Monthly EMI"}),(0,t.jsx)("p",{className:"text-lg font-bold text-primary",children:(0,W.formatCurrency)(A)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Interest Rate"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-card-foreground",children:[C,"% p.a."]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Total Interest"}),(0,t.jsx)("p",{className:"font-semibold text-warning",children:(0,W.formatCurrency)(I)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Total Payable"}),(0,t.jsx)("p",{className:"font-semibold text-card-foreground",children:(0,W.formatCurrency)(L)})]})]})]})}),w&&(0,t.jsx)("div",{className:"rounded-lg bg-destructive/10 p-3 text-sm text-destructive",children:w})]})}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>u(!1),disabled:j,children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:k,disabled:j||0===e.length,children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Application"})]})]})]})}e.s(["ApplyLoanDialog",()=>er],41350)},24917,e=>{"use strict";var t=e.i(93791),r=e.i(75305),a=e.i(30499),n=e.i(67881),s=e.i(30374),i=e.i(62870),l=e.i(47163);function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",e),...r})})}function d({className:e,...r}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",e),...r})}function c({className:e,...r}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",e),...r})}function u({className:e,...r}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function m({className:e,...r}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function x({className:e,...r}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}var h=e.i(30009),p=e.i(64701);let f=(0,e.i(94237).cva)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function g({className:e,variant:r,asChild:a=!1,...n}){let s=a?p.Slot:"span";return(0,t.jsx)(s,{"data-slot":"badge",className:(0,l.cn)(f({variant:r}),e),...n})}var v=e.i(10708),b=e.i(22036),j=e.i(10965);let y=(0,j.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var w=e.i(90768),N=e.i(35301);let S=(0,j.default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var D=e.i(87524),C=e.i(91641),P=e.i(31368);function M({loan:e,accounts:l}){var p;let[f,j]=(0,r.useState)(!1),[M,A]=(0,r.useState)(!1),[L,I]=(0,r.useState)(!1),[E,k]=(0,r.useState)(null),[R,U]=(0,r.useState)(""),T=(0,a.useRouter)(),{user:$}=(0,C.useUser)(),z=async()=>{if(!$||!E||!R)return void b.toast.error("Missing Information",{description:"Please select an account to proceed with payment."});let t=l.find(e=>e.id===R);if(!t)return void b.toast.error("Account Not Found",{description:"The selected account could not be found."});if(t.balance<E.amount)return void b.toast.error("Insufficient Balance",{description:`You need ${E.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})} but only have ${t.balance.toLocaleString("en-US",{style:"currency",currency:"USD"})} in your account.`});A(!0);try{let t=await P.default.post("/api/loans/pay-emi",{loanId:e.id,emiId:E.id,accountId:R});t.data.success&&(b.toast.success("Payment Successful! ðŸŽ‰",{description:`EMI #${E.emiNumber} has been paid successfully. Your new balance is ${t.data.data.newBalance.toLocaleString("en-US",{style:"currency",currency:"USD"})}.`}),I(!1),j(!1),T.refresh())}catch(e){b.toast.error("Payment Failed",{description:e.response?.data?.error||e.message||"Failed to process EMI payment. Please try again."})}finally{A(!1)}},H=e.emiPayments?.sort((e,t)=>e.emiNumber-t.emiNumber)||[],_="active"===e.status||"disbursed"===e.status,V=H.length>0,B="pending"===e.status?"â³ Loan is pending approval from admin.":"approved"===e.status?"âœ“ Loan is approved! Waiting for disbursement.":"rejected"===e.status?"âŒ Loan has been rejected.":"completed"===e.status?"ðŸŽ‰ Congratulations! You have successfully paid all EMIs.":V?null:"ðŸ“‹ EMI schedule will be generated after loan disbursement.";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.Dialog,{open:f,onOpenChange:j,children:[(0,t.jsx)(s.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(n.Button,{variant:"outline",className:"w-full bg-transparent",children:[(0,t.jsx)(y,{className:"mr-2 h-4 w-4"}),"View Details & Pay EMI"]})}),(0,t.jsxs)(s.DialogContent,{className:"sm:max-w-4xl max-h-[85vh] overflow-y-auto",children:[(0,t.jsxs)(s.DialogHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(s.DialogTitle,{className:"capitalize",children:[e.loanType," Loan Details"]}),(p=e.status,(0,t.jsx)(g,{variant:{pending:"secondary",approved:"default",active:"default",rejected:"destructive",completed:"outline",disbursed:"default"}[p]||"secondary",children:p.toUpperCase()}))]}),(0,t.jsx)(s.DialogDescription,{children:"View your EMI schedule and make payments from your accounts."})]}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 rounded-lg bg-muted/50 p-4 sm:grid-cols-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Loan Amount"}),(0,t.jsx)("p",{className:"font-semibold text-card-foreground",children:e.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Interest Rate"}),(0,t.jsxs)("p",{className:"font-semibold text-card-foreground",children:[e.interestRate,"% p.a."]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Amount Paid"}),(0,t.jsx)("p",{className:"font-semibold text-accent",children:e.amountPaid.toLocaleString("en-US",{style:"currency",currency:"USD"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Remaining"}),(0,t.jsx)("p",{className:"font-semibold text-warning",children:e.remainingAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})})]})]}),B&&(0,t.jsx)("div",{className:`rounded-lg p-4 ${"pending"===e.status?"bg-yellow-50 border border-yellow-200":"approved"===e.status?"bg-blue-50 border border-blue-200":"rejected"===e.status?"bg-red-50 border border-red-200":"completed"===e.status?"bg-green-50 border border-green-200":"bg-muted/50 border"}`,children:(0,t.jsx)("p",{className:`text-sm font-medium ${"pending"===e.status?"text-yellow-900":"approved"===e.status?"text-blue-900":"rejected"===e.status?"text-red-900":"completed"===e.status?"text-green-900":"text-muted-foreground"}`,children:B})}),(0,t.jsxs)("div",{className:"rounded-lg border border-border",children:[(0,t.jsxs)("div",{className:"p-4 border-b",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"EMI Schedule"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:_&&V?"Click 'Pay Now' to pay any pending EMI":"EMI payments will be available after disbursement"})]}),(0,t.jsxs)(o,{children:[(0,t.jsx)(d,{children:(0,t.jsxs)(u,{children:[(0,t.jsx)(m,{children:"#"}),(0,t.jsx)(m,{children:"Due Date"}),(0,t.jsx)(m,{children:"EMI Amount"}),(0,t.jsx)(m,{children:"Principal"}),(0,t.jsx)(m,{children:"Interest"}),(0,t.jsx)(m,{children:"Status"}),(0,t.jsx)(m,{className:"text-right",children:"Action"})]})}),(0,t.jsx)(c,{children:H.length?H.map(r=>(0,t.jsxs)(u,{children:[(0,t.jsx)(x,{className:"font-medium",children:r.emiNumber}),(0,t.jsx)(x,{children:new Date(r.dueDate).toLocaleDateString()}),(0,t.jsx)(x,{className:"font-semibold",children:r.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,t.jsx)(x,{children:r.principalAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,t.jsx)(x,{children:r.interestAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,t.jsx)(x,{children:(e=>{switch(e){case"paid":return(0,t.jsxs)(g,{className:"bg-accent text-accent-foreground",children:[(0,t.jsx)(N.CheckCircle2,{className:"mr-1 h-3 w-3"}),"Paid"]});case"pending":return(0,t.jsxs)(g,{variant:"secondary",children:[(0,t.jsx)(S,{className:"mr-1 h-3 w-3"}),"Pending"]});case"overdue":return(0,t.jsxs)(g,{variant:"destructive",children:[(0,t.jsx)(D.AlertCircle,{className:"mr-1 h-3 w-3"}),"Overdue"]});default:return(0,t.jsx)(g,{variant:"outline",children:e})}})(r.status)}),(0,t.jsx)(x,{className:"text-right",children:"pending"===r.status||"overdue"===r.status?(0,t.jsx)(n.Button,{size:"sm",onClick:()=>(t=>{if("active"!==e.status&&"disbursed"!==e.status){let t="Loan must be approved and disbursed first.";"pending"===e.status?t="Loan is still pending approval.":"approved"===e.status?t="Loan is approved but not yet disbursed. Please wait for disbursement.":"rejected"===e.status?t="This loan has been rejected.":"completed"===e.status&&(t="This loan has been fully paid."),b.toast.error("Cannot Pay EMI",{description:`${t} Current status: ${e.status}`});return}k(t);let r=l.find(t=>t.id===e.disbursementAccountId)||l[0];r&&U(r.id),I(!0)})(r),disabled:!_,children:"Pay Now"}):r.paidDate&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Paid on"," ",new Date(r.paidDate).toLocaleDateString()]})})]},r.id)):(0,t.jsx)(u,{children:(0,t.jsx)(x,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"active"===e.status||"disbursed"===e.status?"Loading EMI schedule...":"EMI schedule will be generated after loan disbursement."})})})]})]})]})]})]}),(0,t.jsx)(h.AlertDialog,{open:L,onOpenChange:I,children:(0,t.jsxs)(h.AlertDialogContent,{children:[(0,t.jsxs)(h.AlertDialogHeader,{children:[(0,t.jsxs)(h.AlertDialogTitle,{children:["Pay EMI #",E?.emiNumber]}),(0,t.jsx)(h.AlertDialogDescription,{asChild:!0,children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"rounded-lg bg-muted p-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"EMI Amount:"}),(0,t.jsx)("span",{className:"font-semibold",children:E?.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Due Date:"}),(0,t.jsx)("span",{className:"font-semibold",children:E?.dueDate&&new Date(E.dueDate).toLocaleDateString()})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(v.Label,{children:"Select Payment Account"}),(0,t.jsxs)(i.Select,{value:R,onValueChange:U,children:[(0,t.jsx)(i.SelectTrigger,{children:(0,t.jsx)(i.SelectValue,{placeholder:"Choose account"})}),(0,t.jsx)(i.SelectContent,{children:l.map(e=>(0,t.jsx)(i.SelectItem,{value:e.id,children:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"capitalize font-medium",children:e.accountType}),(0,t.jsx)("span",{className:"font-mono text-xs text-muted-foreground",children:e.accountNumber})]}),(0,t.jsxs)("span",{className:`text-sm ${e.balance<(E?.amount||0)?"text-destructive":"text-accent"}`,children:["Balance:"," ",e.balance.toLocaleString("en-US",{style:"currency",currency:"USD"})]})]})},e.id))})]})]}),R&&E&&(0,t.jsx)("div",{className:"text-sm",children:l.find(e=>e.id===R)?.balance<E.amount?(0,t.jsx)("div",{className:"text-destructive bg-destructive/10 p-2 rounded",children:"âš ï¸ Insufficient balance in selected account"}):(0,t.jsx)("div",{className:"text-accent bg-accent/10 p-2 rounded",children:"âœ“ Payment will be deducted from this account"})})]})})]}),(0,t.jsxs)(h.AlertDialogFooter,{children:[(0,t.jsx)(h.AlertDialogCancel,{disabled:M,children:"Cancel"}),(0,t.jsx)(h.AlertDialogAction,{onClick:z,disabled:(()=>{if(M||!R||!E)return!0;let e=l.find(e=>e.id===R);return!e||e.balance<E.amount})(),children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Confirm Payment"})]})]})})]})}e.s(["LoanDetailsDialog",()=>M],24917)}]);