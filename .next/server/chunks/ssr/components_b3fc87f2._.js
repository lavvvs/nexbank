module.exports=[2150,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50104),e=a.i(30553),f="Progress",[g,h]=(0,d.createContextScope)(f),[i,j]=g(f),k=c.forwardRef((a,c)=>{var d,f;let{__scopeProgress:g,value:h=null,max:j,getValueLabel:k=n,...l}=a;(j||0===j)&&!q(j)&&console.error((d=`${j}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let m=q(j)?j:100;null===h||r(h,m)||console.error((f=`${h}`,`Invalid prop \`value\` of value \`${f}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let s=r(h,m)?h:null,t=p(s)?k(s,m):void 0;return(0,b.jsx)(i,{scope:g,value:s,max:m,children:(0,b.jsx)(e.Primitive.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":p(s)?s:void 0,"aria-valuetext":t,role:"progressbar","data-state":o(s,m),"data-value":s??void 0,"data-max":m,...l,ref:c})})});k.displayName=f;var l="ProgressIndicator",m=c.forwardRef((a,c)=>{let{__scopeProgress:d,...f}=a,g=j(l,d);return(0,b.jsx)(e.Primitive.div,{"data-state":o(g.value,g.max),"data-value":g.value??void 0,"data-max":g.max,...f,ref:c})});function n(a,b){return`${Math.round(a/b*100)}%`}function o(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function p(a){return"number"==typeof a}function q(a){return p(a)&&!isNaN(a)&&a>0}function r(a,b){return p(a)&&!isNaN(a)&&a<=b&&a>=0}m.displayName=l;var s=a.i(97895);function t({className:a,value:c,...d}){return(0,b.jsx)(k,{"data-slot":"progress",className:(0,s.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",a),...d,children:(0,b.jsx)(m,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})})}a.s(["Progress",()=>t],2150)},21681,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(65733),g=a.i(87682),h=a.i(5522),i=a.i(17171),j=a.i(30656),k=a.i(7554),l=a.i(70121),m=a.i(50104),n=a.i(25152),o=a.i(7827),p=a.i(77994),q=a.i(3688),r=a.i(30553),s=a.i(37738),t=["PageUp","PageDown"],u=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],v={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},w="Slider",[x,y,z]=(0,s.createCollection)(w),[A,B]=(0,m.createContextScope)(w,[z]),[C,D]=A(w),E=c.forwardRef((a,d)=>{let{name:e,min:f=0,max:g=100,step:h=1,orientation:i="horizontal",disabled:l=!1,minStepsBetweenThumbs:m=0,defaultValue:o=[f],value:p,onValueChange:q=()=>{},onValueCommit:r=()=>{},inverted:s=!1,form:v,...w}=a,y=c.useRef(new Set),z=c.useRef(0),A="horizontal"===i,[B=[],D]=(0,n.useControllableState)({prop:p,defaultProp:o,onChange:a=>{let b=[...y.current];b[z.current]?.focus(),q(a)}}),E=c.useRef(B);function F(a,b,{commit:c}={commit:!1}){let d,e=(String(h).split(".")[1]||"").length,i=Math.round((Math.round((a-f)/h)*h+f)*(d=Math.pow(10,e)))/d,k=(0,j.clamp)(i,[f,g]);D((a=[])=>{let d=function(a=[],b,c){let d=[...a];return d[c]=b,d.sort((a,b)=>a-b)}(a,k,b);if(!function(a,b){if(b>0)return Math.min(...a.slice(0,-1).map((b,c)=>a[c+1]-b))>=b;return!0}(d,m*h))return a;{z.current=d.indexOf(k);let b=String(d)!==String(a);return b&&c&&r(d),b?d:a}})}return(0,b.jsx)(C,{scope:a.__scopeSlider,name:e,disabled:l,min:f,max:g,valueIndexToChangeRef:z,thumbs:y.current,values:B,orientation:i,form:v,children:(0,b.jsx)(x.Provider,{scope:a.__scopeSlider,children:(0,b.jsx)(x.Slot,{scope:a.__scopeSlider,children:(0,b.jsx)(A?H:I,{"aria-disabled":l,"data-disabled":l?"":void 0,...w,ref:d,onPointerDown:(0,k.composeEventHandlers)(w.onPointerDown,()=>{l||(E.current=B)}),min:f,max:g,inverted:s,onSlideStart:l?void 0:function(a){let b=function(a,b){if(1===a.length)return 0;let c=a.map(a=>Math.abs(a-b)),d=Math.min(...c);return c.indexOf(d)}(B,a);F(a,b)},onSlideMove:l?void 0:function(a){F(a,z.current)},onSlideEnd:l?void 0:function(){let a=E.current[z.current];B[z.current]!==a&&r(B)},onHomeKeyDown:()=>!l&&F(f,0,{commit:!0}),onEndKeyDown:()=>!l&&F(g,B.length-1,{commit:!0}),onStepKeyDown:({event:a,direction:b})=>{if(!l){let c=t.includes(a.key)||a.shiftKey&&u.includes(a.key),d=z.current;F(B[d]+h*(c?10:1)*b,d,{commit:!0})}}})})})})});E.displayName=w;var[F,G]=A(w,{startEdge:"left",endEdge:"right",size:"width",direction:1}),H=c.forwardRef((a,d)=>{let{min:e,max:f,dir:g,inverted:h,onSlideStart:i,onSlideMove:j,onSlideEnd:k,onStepKeyDown:m,...n}=a,[p,q]=c.useState(null),r=(0,l.useComposedRefs)(d,a=>q(a)),s=c.useRef(void 0),t=(0,o.useDirection)(g),u="ltr"===t,w=u&&!h||!u&&h;function x(a){let b=s.current||p.getBoundingClientRect(),c=T([0,b.width],w?[e,f]:[f,e]);return s.current=b,c(a-b.left)}return(0,b.jsx)(F,{scope:a.__scopeSlider,startEdge:w?"left":"right",endEdge:w?"right":"left",direction:w?1:-1,size:"width",children:(0,b.jsx)(J,{dir:t,"data-orientation":"horizontal",...n,ref:r,style:{...n.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:a=>{let b=x(a.clientX);i?.(b)},onSlideMove:a=>{let b=x(a.clientX);j?.(b)},onSlideEnd:()=>{s.current=void 0,k?.()},onStepKeyDown:a=>{let b=v[w?"from-left":"from-right"].includes(a.key);m?.({event:a,direction:b?-1:1})}})})}),I=c.forwardRef((a,d)=>{let{min:e,max:f,inverted:g,onSlideStart:h,onSlideMove:i,onSlideEnd:j,onStepKeyDown:k,...m}=a,n=c.useRef(null),o=(0,l.useComposedRefs)(d,n),p=c.useRef(void 0),q=!g;function r(a){let b=p.current||n.current.getBoundingClientRect(),c=T([0,b.height],q?[f,e]:[e,f]);return p.current=b,c(a-b.top)}return(0,b.jsx)(F,{scope:a.__scopeSlider,startEdge:q?"bottom":"top",endEdge:q?"top":"bottom",size:"height",direction:q?1:-1,children:(0,b.jsx)(J,{"data-orientation":"vertical",...m,ref:o,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:a=>{let b=r(a.clientY);h?.(b)},onSlideMove:a=>{let b=r(a.clientY);i?.(b)},onSlideEnd:()=>{p.current=void 0,j?.()},onStepKeyDown:a=>{let b=v[q?"from-bottom":"from-top"].includes(a.key);k?.({event:a,direction:b?-1:1})}})})}),J=c.forwardRef((a,c)=>{let{__scopeSlider:d,onSlideStart:e,onSlideMove:f,onSlideEnd:g,onHomeKeyDown:h,onEndKeyDown:i,onStepKeyDown:j,...l}=a,m=D(w,d);return(0,b.jsx)(r.Primitive.span,{...l,ref:c,onKeyDown:(0,k.composeEventHandlers)(a.onKeyDown,a=>{"Home"===a.key?(h(a),a.preventDefault()):"End"===a.key?(i(a),a.preventDefault()):t.concat(u).includes(a.key)&&(j(a),a.preventDefault())}),onPointerDown:(0,k.composeEventHandlers)(a.onPointerDown,a=>{let b=a.target;b.setPointerCapture(a.pointerId),a.preventDefault(),m.thumbs.has(b)?b.focus():e(a)}),onPointerMove:(0,k.composeEventHandlers)(a.onPointerMove,a=>{a.target.hasPointerCapture(a.pointerId)&&f(a)}),onPointerUp:(0,k.composeEventHandlers)(a.onPointerUp,a=>{let b=a.target;b.hasPointerCapture(a.pointerId)&&(b.releasePointerCapture(a.pointerId),g(a))})})}),K="SliderTrack",L=c.forwardRef((a,c)=>{let{__scopeSlider:d,...e}=a,f=D(K,d);return(0,b.jsx)(r.Primitive.span,{"data-disabled":f.disabled?"":void 0,"data-orientation":f.orientation,...e,ref:c})});L.displayName=K;var M="SliderRange",N=c.forwardRef((a,d)=>{let{__scopeSlider:e,...f}=a,g=D(M,e),h=G(M,e),i=c.useRef(null),j=(0,l.useComposedRefs)(d,i),k=g.values.length,m=g.values.map(a=>S(a,g.min,g.max)),n=k>1?Math.min(...m):0,o=100-Math.max(...m);return(0,b.jsx)(r.Primitive.span,{"data-orientation":g.orientation,"data-disabled":g.disabled?"":void 0,...f,ref:j,style:{...a.style,[h.startEdge]:n+"%",[h.endEdge]:o+"%"}})});N.displayName=M;var O="SliderThumb",P=c.forwardRef((a,d)=>{let e=y(a.__scopeSlider),[f,g]=c.useState(null),h=(0,l.useComposedRefs)(d,a=>g(a)),i=c.useMemo(()=>f?e().findIndex(a=>a.ref.current===f):-1,[e,f]);return(0,b.jsx)(Q,{...a,ref:h,index:i})}),Q=c.forwardRef((a,d)=>{var e,f,g,h,i;let j,m,{__scopeSlider:n,index:o,name:p,...s}=a,t=D(O,n),u=G(O,n),[v,w]=c.useState(null),y=(0,l.useComposedRefs)(d,a=>w(a)),z=!v||t.form||!!v.closest("form"),A=(0,q.useSize)(v),B=t.values[o],C=void 0===B?0:S(B,t.min,t.max),E=(e=o,(f=t.values.length)>2?`Value ${e+1} of ${f}`:2===f?["Minimum","Maximum"][e]:void 0),F=A?.[u.size],H=F?(g=F,h=C,i=u.direction,m=T([0,50],[0,j=g/2]),(j-m(h)*i)*i):0;return c.useEffect(()=>{if(v)return t.thumbs.add(v),()=>{t.thumbs.delete(v)}},[v,t.thumbs]),(0,b.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[u.startEdge]:`calc(${C}% + ${H}px)`},children:[(0,b.jsx)(x.ItemSlot,{scope:a.__scopeSlider,children:(0,b.jsx)(r.Primitive.span,{role:"slider","aria-label":a["aria-label"]||E,"aria-valuemin":t.min,"aria-valuenow":B,"aria-valuemax":t.max,"aria-orientation":t.orientation,"data-orientation":t.orientation,"data-disabled":t.disabled?"":void 0,tabIndex:t.disabled?void 0:0,...s,ref:y,style:void 0===B?{display:"none"}:a.style,onFocus:(0,k.composeEventHandlers)(a.onFocus,()=>{t.valueIndexToChangeRef.current=o})})}),z&&(0,b.jsx)(R,{name:p??(t.name?t.name+(t.values.length>1?"[]":""):void 0),form:t.form,value:B},o)]})});P.displayName=O;var R=a=>{let{value:d,...e}=a,f=c.useRef(null),g=(0,p.usePrevious)(d);return c.useEffect(()=>{let a=f.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(g!==d&&b){let c=new Event("input",{bubbles:!0});b.call(a,d),a.dispatchEvent(c)}},[g,d]),(0,b.jsx)("input",{style:{display:"none"},...e,ref:f,defaultValue:d})};function S(a,b,c){return(0,j.clamp)(100/(c-b)*(a-b),[0,100])}function T(a,b){return c=>{if(a[0]===a[1]||b[0]===b[1])return b[0];let d=(b[1]-b[0])/(a[1]-a[0]);return b[0]+d*(c-a[0])}}var U=a.i(97895);function V({className:a,defaultValue:d,value:e,min:f=0,max:g=100,...h}){let i=c.useMemo(()=>Array.isArray(e)?e:Array.isArray(d)?d:[f,g],[e,d,f,g]);return(0,b.jsxs)(E,{"data-slot":"slider",defaultValue:d,value:e,min:f,max:g,className:(0,U.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...h,children:[(0,b.jsx)(L,{"data-slot":"slider-track",className:(0,U.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,b.jsx)(N,{"data-slot":"slider-range",className:(0,U.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:i.length},(a,c)=>(0,b.jsx)(P,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},c))]})}var W=a.i(3130),X=a.i(74897),Y=a.i(15618),Z=a.i(96221);let $=(0,a.i(70106).default)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var _=a.i(20180),aa=a.i(83490);let ab=[{value:"personal",label:"Personal Loan",icon:"ðŸ’°"},{value:"home",label:"Home Loan",icon:"ðŸ "},{value:"education",label:"Education Loan",icon:"ðŸŽ“"},{value:"vehicle",label:"Vehicle Loan",icon:"ðŸš—"},{value:"business",label:"Business Loan",icon:"ðŸ’¼"}];function ac({accounts:a,interestRates:j}){let[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)([12]),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(null),y=(0,d.useRouter)(),{user:z}=(0,_.useUser)(),A=m?j[m]||12:0,B=Number.parseFloat(o)||0,C=q[0],D=B>0?(0,X.calculateEMI)(B,A,C):0,E=D*C,F=E-B,G=()=>{n(""),p(""),r([12]),t(""),x(null)},H=async()=>{if(!m||!o||!s)return void x("Please fill in all required fields");if(B<1e3)return void x("Minimum loan amount is $1,000");if(!z)return void x("You must be logged in");v(!0),x(null);try{await aa.default.post("/api/loans",{userId:z.id,loanType:m,amount:B,interestRate:A,tenureMonths:C,emiAmount:D,totalPayable:E,remainingAmount:E,status:"pending",disbursementAccountId:s}),l(!1),G(),y.refresh()}catch(a){x(a.response?.data?.error||"Something went wrong")}finally{v(!1)}};return(0,b.jsxs)(f.Dialog,{open:k,onOpenChange:a=>{l(a),a||G()},children:[(0,b.jsx)(f.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{children:[(0,b.jsx)(Y.Plus,{className:"mr-2 h-4 w-4"}),"Apply for Loan"]})}),(0,b.jsxs)(f.DialogContent,{className:"sm:max-w-lg max-h-[90vh] flex flex-col",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"Apply for a Loan"}),(0,b.jsx)(f.DialogDescription,{children:"Fill in the details to submit your loan application."})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto pr-2",children:(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Loan Type"}),(0,b.jsxs)(g.Select,{value:m,onValueChange:n,children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Select loan type"})}),(0,b.jsx)(g.SelectContent,{children:ab.map(a=>(0,b.jsx)(g.SelectItem,{value:a.value,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:a.icon}),(0,b.jsx)("span",{children:a.label}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["@ ",j[a.value]||12,"% p.a."]})]})},a.value))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Loan Amount (USD)"}),(0,b.jsx)(h.Input,{type:"number",placeholder:"Minimum $1,000",value:o,onChange:a=>p(a.target.value),min:1e3,step:100})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(i.Label,{children:"Tenure"}),(0,b.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:[C," months"]})]}),(0,b.jsx)(V,{value:q,onValueChange:r,min:6,max:60,step:6,className:"py-2"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"6 months"}),(0,b.jsx)("span",{children:"60 months"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Disbursement Account"}),(0,b.jsxs)(g.Select,{value:s,onValueChange:t,children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Select account"})}),(0,b.jsx)(g.SelectContent,{children:a.map(a=>(0,b.jsx)(g.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"capitalize",children:a.accountType}),(0,b.jsx)("span",{className:"font-mono text-xs text-muted-foreground",children:a.accountNumber})]})},a.id))})]})]}),B>0&&m&&(0,b.jsx)(W.Card,{className:"border-0 bg-muted/50",children:(0,b.jsxs)(W.CardContent,{className:"p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground mb-3",children:[(0,b.jsx)($,{className:"h-4 w-4"}),"Loan Summary"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Monthly EMI"}),(0,b.jsx)("p",{className:"text-lg font-bold text-primary",children:(0,X.formatCurrency)(D)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Interest Rate"}),(0,b.jsxs)("p",{className:"text-lg font-bold text-card-foreground",children:[A,"% p.a."]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Total Interest"}),(0,b.jsx)("p",{className:"font-semibold text-warning",children:(0,X.formatCurrency)(F)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Total Payable"}),(0,b.jsx)("p",{className:"font-semibold text-card-foreground",children:(0,X.formatCurrency)(E)})]})]})]})}),w&&(0,b.jsx)("div",{className:"rounded-lg bg-destructive/10 p-3 text-sm text-destructive",children:w})]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>l(!1),disabled:u,children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:H,disabled:u||0===a.length,children:u?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Z.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Application"})]})]})]})}a.s(["ApplyLoanDialog",()=>ac],21681)},97302,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(65733),g=a.i(87682),h=a.i(97895);function i({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,h.cn)("w-full caption-bottom text-sm",a),...c})})}function j({className:a,...c}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,h.cn)("[&_tr]:border-b",a),...c})}function k({className:a,...c}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,h.cn)("[&_tr:last-child]:border-0",a),...c})}function l({className:a,...c}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,h.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...c})}function m({className:a,...c}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,h.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function n({className:a,...c}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,h.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}var o=a.i(5094),p=a.i(11011);let q=(0,a.i(187).cva)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function r({className:a,variant:c,asChild:d=!1,...e}){let f=d?p.Slot:"span";return(0,b.jsx)(f,{"data-slot":"badge",className:(0,h.cn)(q({variant:c}),a),...e})}var s=a.i(17171),t=a.i(23292),u=a.i(70106);let v=(0,u.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var w=a.i(96221),x=a.i(67453);let y=(0,u.default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var z=a.i(92e3),A=a.i(20180),B=a.i(83490);function C({loan:a,accounts:h}){var p;let[q,u]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(""),K=(0,d.useRouter)(),{user:L}=(0,A.useUser)(),M=async()=>{if(!L||!G||!I)return void t.toast.error("Missing Information",{description:"Please select an account to proceed with payment."});let b=h.find(a=>a.id===I);if(!b)return void t.toast.error("Account Not Found",{description:"The selected account could not be found."});if(b.balance<G.amount)return void t.toast.error("Insufficient Balance",{description:`You need ${G.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})} but only have ${b.balance.toLocaleString("en-US",{style:"currency",currency:"USD"})} in your account.`});D(!0);try{let b=await B.default.post("/api/loans/pay-emi",{loanId:a.id,emiId:G.id,accountId:I});b.data.success&&(t.toast.success("Payment Successful! ðŸŽ‰",{description:`EMI #${G.emiNumber} has been paid successfully. Your new balance is ${b.data.data.newBalance.toLocaleString("en-US",{style:"currency",currency:"USD"})}.`}),F(!1),u(!1),K.refresh())}catch(a){t.toast.error("Payment Failed",{description:a.response?.data?.error||a.message||"Failed to process EMI payment. Please try again."})}finally{D(!1)}},N=a.emiPayments?.sort((a,b)=>a.emiNumber-b.emiNumber)||[],O="active"===a.status||"disbursed"===a.status,P=N.length>0,Q="pending"===a.status?"â³ Loan is pending approval from admin.":"approved"===a.status?"âœ“ Loan is approved! Waiting for disbursement.":"rejected"===a.status?"âŒ Loan has been rejected.":"completed"===a.status?"ðŸŽ‰ Congratulations! You have successfully paid all EMIs.":P?null:"ðŸ“‹ EMI schedule will be generated after loan disbursement.";return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(f.Dialog,{open:q,onOpenChange:u,children:[(0,b.jsx)(f.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"outline",className:"w-full bg-transparent",children:[(0,b.jsx)(v,{className:"mr-2 h-4 w-4"}),"View Details & Pay EMI"]})}),(0,b.jsxs)(f.DialogContent,{className:"sm:max-w-4xl max-h-[85vh] overflow-y-auto",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(f.DialogTitle,{className:"capitalize",children:[a.loanType," Loan Details"]}),(p=a.status,(0,b.jsx)(r,{variant:{pending:"secondary",approved:"default",active:"default",rejected:"destructive",completed:"outline",disbursed:"default"}[p]||"secondary",children:p.toUpperCase()}))]}),(0,b.jsx)(f.DialogDescription,{children:"View your EMI schedule and make payments from your accounts."})]}),(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 rounded-lg bg-muted/50 p-4 sm:grid-cols-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Loan Amount"}),(0,b.jsx)("p",{className:"font-semibold text-card-foreground",children:a.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Interest Rate"}),(0,b.jsxs)("p",{className:"font-semibold text-card-foreground",children:[a.interestRate,"% p.a."]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Amount Paid"}),(0,b.jsx)("p",{className:"font-semibold text-accent",children:a.amountPaid.toLocaleString("en-US",{style:"currency",currency:"USD"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Remaining"}),(0,b.jsx)("p",{className:"font-semibold text-warning",children:a.remainingAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})})]})]}),Q&&(0,b.jsx)("div",{className:`rounded-lg p-4 ${"pending"===a.status?"bg-yellow-50 border border-yellow-200":"approved"===a.status?"bg-blue-50 border border-blue-200":"rejected"===a.status?"bg-red-50 border border-red-200":"completed"===a.status?"bg-green-50 border border-green-200":"bg-muted/50 border"}`,children:(0,b.jsx)("p",{className:`text-sm font-medium ${"pending"===a.status?"text-yellow-900":"approved"===a.status?"text-blue-900":"rejected"===a.status?"text-red-900":"completed"===a.status?"text-green-900":"text-muted-foreground"}`,children:Q})}),(0,b.jsxs)("div",{className:"rounded-lg border border-border",children:[(0,b.jsxs)("div",{className:"p-4 border-b",children:[(0,b.jsx)("h3",{className:"font-semibold",children:"EMI Schedule"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:O&&P?"Click 'Pay Now' to pay any pending EMI":"EMI payments will be available after disbursement"})]}),(0,b.jsxs)(i,{children:[(0,b.jsx)(j,{children:(0,b.jsxs)(l,{children:[(0,b.jsx)(m,{children:"#"}),(0,b.jsx)(m,{children:"Due Date"}),(0,b.jsx)(m,{children:"EMI Amount"}),(0,b.jsx)(m,{children:"Principal"}),(0,b.jsx)(m,{children:"Interest"}),(0,b.jsx)(m,{children:"Status"}),(0,b.jsx)(m,{className:"text-right",children:"Action"})]})}),(0,b.jsx)(k,{children:N.length?N.map(c=>(0,b.jsxs)(l,{children:[(0,b.jsx)(n,{className:"font-medium",children:c.emiNumber}),(0,b.jsx)(n,{children:new Date(c.dueDate).toLocaleDateString()}),(0,b.jsx)(n,{className:"font-semibold",children:c.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,b.jsx)(n,{children:c.principalAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,b.jsx)(n,{children:c.interestAmount.toLocaleString("en-US",{style:"currency",currency:"USD"})}),(0,b.jsx)(n,{children:(a=>{switch(a){case"paid":return(0,b.jsxs)(r,{className:"bg-accent text-accent-foreground",children:[(0,b.jsx)(x.CheckCircle2,{className:"mr-1 h-3 w-3"}),"Paid"]});case"pending":return(0,b.jsxs)(r,{variant:"secondary",children:[(0,b.jsx)(y,{className:"mr-1 h-3 w-3"}),"Pending"]});case"overdue":return(0,b.jsxs)(r,{variant:"destructive",children:[(0,b.jsx)(z.AlertCircle,{className:"mr-1 h-3 w-3"}),"Overdue"]});default:return(0,b.jsx)(r,{variant:"outline",children:a})}})(c.status)}),(0,b.jsx)(n,{className:"text-right",children:"pending"===c.status||"overdue"===c.status?(0,b.jsx)(e.Button,{size:"sm",onClick:()=>(b=>{if("active"!==a.status&&"disbursed"!==a.status){let b="Loan must be approved and disbursed first.";"pending"===a.status?b="Loan is still pending approval.":"approved"===a.status?b="Loan is approved but not yet disbursed. Please wait for disbursement.":"rejected"===a.status?b="This loan has been rejected.":"completed"===a.status&&(b="This loan has been fully paid."),t.toast.error("Cannot Pay EMI",{description:`${b} Current status: ${a.status}`});return}H(b);let c=h.find(b=>b.id===a.disbursementAccountId)||h[0];c&&J(c.id),F(!0)})(c),disabled:!O,children:"Pay Now"}):c.paidDate&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Paid on"," ",new Date(c.paidDate).toLocaleDateString()]})})]},c.id)):(0,b.jsx)(l,{children:(0,b.jsx)(n,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"active"===a.status||"disbursed"===a.status?"Loading EMI schedule...":"EMI schedule will be generated after loan disbursement."})})})]})]})]})]})]}),(0,b.jsx)(o.AlertDialog,{open:E,onOpenChange:F,children:(0,b.jsxs)(o.AlertDialogContent,{children:[(0,b.jsxs)(o.AlertDialogHeader,{children:[(0,b.jsxs)(o.AlertDialogTitle,{children:["Pay EMI #",G?.emiNumber]}),(0,b.jsx)(o.AlertDialogDescription,{asChild:!0,children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"rounded-lg bg-muted p-4 space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"EMI Amount:"}),(0,b.jsx)("span",{className:"font-semibold",children:G?.amount.toLocaleString("en-US",{style:"currency",currency:"USD"})})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Due Date:"}),(0,b.jsx)("span",{className:"font-semibold",children:G?.dueDate&&new Date(G.dueDate).toLocaleDateString()})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Select Payment Account"}),(0,b.jsxs)(g.Select,{value:I,onValueChange:J,children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Choose account"})}),(0,b.jsx)(g.SelectContent,{children:h.map(a=>(0,b.jsx)(g.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"capitalize font-medium",children:a.accountType}),(0,b.jsx)("span",{className:"font-mono text-xs text-muted-foreground",children:a.accountNumber})]}),(0,b.jsxs)("span",{className:`text-sm ${a.balance<(G?.amount||0)?"text-destructive":"text-accent"}`,children:["Balance:"," ",a.balance.toLocaleString("en-US",{style:"currency",currency:"USD"})]})]})},a.id))})]})]}),I&&G&&(0,b.jsx)("div",{className:"text-sm",children:h.find(a=>a.id===I)?.balance<G.amount?(0,b.jsx)("div",{className:"text-destructive bg-destructive/10 p-2 rounded",children:"âš ï¸ Insufficient balance in selected account"}):(0,b.jsx)("div",{className:"text-accent bg-accent/10 p-2 rounded",children:"âœ“ Payment will be deducted from this account"})})]})})]}),(0,b.jsxs)(o.AlertDialogFooter,{children:[(0,b.jsx)(o.AlertDialogCancel,{disabled:C,children:"Cancel"}),(0,b.jsx)(o.AlertDialogAction,{onClick:M,disabled:(()=>{if(C||!I||!G)return!0;let a=h.find(a=>a.id===I);return!a||a.balance<G.amount})(),children:C?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Confirm Payment"})]})]})})]})}a.s(["LoanDetailsDialog",()=>C],97302)}];

//# sourceMappingURL=components_b3fc87f2._.js.map