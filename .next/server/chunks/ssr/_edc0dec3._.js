module.exports=[76874,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Progress() from the server but Progress is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/progress.tsx <module evaluation>","Progress");a.s(["Progress",0,b])},253,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Progress() from the server but Progress is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/ui/progress.tsx","Progress");a.s(["Progress",0,b])},70100,a=>{"use strict";a.i(76874);var b=a.i(253);a.n(b)},63715,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ApplyLoanDialog() from the server but ApplyLoanDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/dashboard/apply-loan-dialog.tsx <module evaluation>","ApplyLoanDialog");a.s(["ApplyLoanDialog",0,b])},83105,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call ApplyLoanDialog() from the server but ApplyLoanDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/dashboard/apply-loan-dialog.tsx","ApplyLoanDialog");a.s(["ApplyLoanDialog",0,b])},95984,a=>{"use strict";a.i(63715);var b=a.i(83105);a.n(b)},80911,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call LoanDetailsDialog() from the server but LoanDetailsDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/dashboard/loan-details-dialog.tsx <module evaluation>","LoanDetailsDialog");a.s(["LoanDetailsDialog",0,b])},48278,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call LoanDetailsDialog() from the server but LoanDetailsDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/components/dashboard/loan-details-dialog.tsx","LoanDetailsDialog");a.s(["LoanDetailsDialog",0,b])},49555,a=>{"use strict";a.i(80911);var b=a.i(48278);a.n(b)},55726,a=>{"use strict";var b=a.i(7997);a.i(70396);var c=a.i(73727),d=a.i(22017),e=a.i(13761),f=a.i(29171),g=a.i(40088),h=a.i(70100),i=a.i(44632),j=a.i(95984),k=a.i(49555),l=a.i(96921),m=a.i(56603),n=a.i(10734),o=a.i(93830),p=a.i(21679),q=a.i(91222);async function r(){await (0,d.default)();let a=await (0,q.currentUser)();a||(0,c.redirect)("/auth/login");let r=a.id,s=(await e.Account.find({userId:r,status:"active"}).lean()).map(a=>({id:a._id.toString(),userId:a.userId,accountNumber:a.accountNumber,accountType:a.accountType,balance:a.balance||0,status:a.status})),t=await e.Loan.find({userId:r}).sort({createdAt:-1}).lean(),u=await e.BankSetting.find({}).lean(),v={};u?.forEach(a=>{a.settingKey?.endsWith("_loan_rate")&&(v[a.settingKey.replace("_loan_rate","")]=parseFloat(a.settingValue))}),0===Object.keys(v).length&&(v.personal=12,v.home=8,v.education=10,v.vehicle=11,v.business=14);let w=async a=>e.EmiPayment.countDocuments({loanId:a,status:"pending"}).exec(),x=await Promise.all(t.map(async a=>{let b=await w(a._id),c=(await e.EmiPayment.find({loanId:a._id}).sort({emiNumber:1}).lean()).map(a=>({id:a._id.toString(),emiNumber:a.emiNumber,dueDate:a.dueDate.toISOString(),amount:a.amount,principalAmount:a.principalAmount,interestAmount:a.interestAmount,status:a.status,paidDate:a.paidDate?.toISOString()}));return{id:a._id.toString(),userId:a.userId,loanType:a.loanType,amount:a.amount,interestRate:a.interestRate,tenureMonths:a.tenureMonths,emiAmount:a.emiAmount,totalPayable:a.totalPayable,amountPaid:a.amountPaid||0,remainingAmount:a.remainingAmount||a.totalPayable,status:a.status,disbursementAccountId:a.disbursementAccountId?.toString(),nextEmiDate:a.nextEmiDate?.toISOString(),createdAt:a.createdAt.toISOString(),pendingEMIs:b,emiPayments:c}})),y=x.filter(a=>["active","disbursed"].includes(a.status)),z=y.reduce((a,b)=>a+Number(b.amount),0),A=y.reduce((a,b)=>a+Number(b.remainingAmount),0),B=y.reduce((a,b)=>a+Number(b.amountPaid),0);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground",children:"Loans"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your loans and track EMI payments"})]}),(0,b.jsx)(j.ApplyLoanDialog,{accounts:s,interestRates:v})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,b.jsx)(f.Card,{className:"border-0 shadow-sm",children:(0,b.jsxs)(f.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:(0,b.jsx)(l.Landmark,{className:"h-5 w-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Borrowed"}),(0,b.jsx)("p",{className:"text-xl font-bold text-primary",children:(0,i.formatCurrency)(z)})]})]})}),(0,b.jsx)(f.Card,{className:"border-0 shadow-sm",children:(0,b.jsxs)(f.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-accent/10",children:(0,b.jsx)(n.CheckCircle2,{className:"h-5 w-5 text-accent"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Paid"}),(0,b.jsx)("p",{className:"text-xl font-bold text-accent",children:(0,i.formatCurrency)(B)})]})]})}),(0,b.jsx)(f.Card,{className:"border-0 shadow-sm",children:(0,b.jsxs)(f.CardContent,{className:"p-4 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-warning/10",children:(0,b.jsx)(m.Clock,{className:"h-5 w-5 text-warning"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),(0,b.jsx)("p",{className:"text-xl font-bold text-warning",children:(0,i.formatCurrency)(A)})]})]})})]}),x.length>0?(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:x.map(a=>{let c=a.totalPayable>0?Number(a.amountPaid)/Number(a.totalPayable)*100:0;return(0,b.jsxs)(f.Card,{className:"border-0 shadow-sm",children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-muted text-2xl",children:(a=>{switch(a){case"home":return"ðŸ ";case"vehicle":return"ðŸš—";case"education":return"ðŸŽ“";case"business":return"ðŸ’¼";default:return"ðŸ’°"}})(a.loanType)}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(f.CardTitle,{className:"text-base font-semibold capitalize",children:[a.loanType," Loan"]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.tenureMonths," months @ ",a.interestRate,"%"]})]})]}),(a=>{switch(a){case"pending":return(0,b.jsxs)(g.Badge,{variant:"secondary",children:[(0,b.jsx)(m.Clock,{className:"mr-1 h-3 w-3"}),"Pending"]});case"approved":return(0,b.jsxs)(g.Badge,{className:"bg-primary",children:[(0,b.jsx)(n.CheckCircle2,{className:"mr-1 h-3 w-3"}),"Approved"]});case"rejected":return(0,b.jsxs)(g.Badge,{variant:"destructive",children:[(0,b.jsx)(o.XCircle,{className:"mr-1 h-3 w-3"}),"Rejected"]});case"disbursed":case"active":return(0,b.jsxs)(g.Badge,{className:"bg-accent text-accent-foreground",children:[(0,b.jsx)(n.CheckCircle2,{className:"mr-1 h-3 w-3"}),"Active"]});case"closed":return(0,b.jsxs)(g.Badge,{variant:"outline",children:[(0,b.jsx)(n.CheckCircle2,{className:"mr-1 h-3 w-3"}),"Closed"]});case"defaulted":return(0,b.jsxs)(g.Badge,{variant:"destructive",children:[(0,b.jsx)(p.AlertCircle,{className:"mr-1 h-3 w-3"}),"Defaulted"]});default:return(0,b.jsx)(g.Badge,{variant:"outline",children:a})}})(a.status)]})}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Loan Amount"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-card-foreground",children:(0,i.formatCurrency)(a.amount)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"EMI Amount"}),(0,b.jsx)("p",{className:"text-lg font-semibold text-card-foreground",children:(0,i.formatCurrency)(a.emiAmount)})]})]}),["active","disbursed"].includes(a.status)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Repayment Progress"}),(0,b.jsxs)("span",{className:"font-medium text-card-foreground",children:[c.toFixed(1),"%"]})]}),(0,b.jsx)(h.Progress,{value:c,className:"h-2"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Remaining"}),(0,b.jsx)("p",{className:"font-semibold text-card-foreground",children:(0,i.formatCurrency)(a.remainingAmount)})]}),a.nextEmiDate&&(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Next EMI"}),(0,b.jsx)("p",{className:"font-semibold text-warning",children:(0,i.formatDate)(new Date(a.nextEmiDate))})]})]}),a.pendingEMIs>0&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.pendingEMIs," EMI",a.pendingEMIs>1?"s":""," pending"]})]}),"pending"===a.status&&(0,b.jsx)("div",{className:"rounded-lg bg-secondary/50 p-3",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your loan application is being reviewed."})}),"approved"===a.status&&(0,b.jsx)("div",{className:"rounded-lg bg-primary/10 p-3",children:(0,b.jsx)("p",{className:"text-sm text-primary",children:"Your loan has been approved! Disbursement will be processed soon."})}),["active","disbursed"].includes(a.status)&&(0,b.jsx)(k.LoanDetailsDialog,{loan:a,accounts:s})]})]},a.id)})}):(0,b.jsx)(f.Card,{className:"border-0 shadow-sm",children:(0,b.jsxs)(f.CardContent,{className:"flex flex-col items-center justify-center py-16",children:[(0,b.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(l.Landmark,{className:"h-8 w-8 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"mt-4 text-lg font-semibold text-card-foreground",children:"No loans yet"}),(0,b.jsx)("p",{className:"mt-2 text-center text-muted-foreground",children:"Apply for a loan to get started. We offer competitive rates."}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(j.ApplyLoanDialog,{accounts:s,interestRates:v})})]})})]})}a.s(["default",()=>r])}];

//# sourceMappingURL=_edc0dec3._.js.map