module.exports=[54609,a=>{"use strict";a.i(9868);var b=a.i(26847),c=a.i(58313),d=a.i(36822),e=a.i(60128);function f(a){let b=JSON.stringify(a),c=new TextEncoder().encode(b);return d.base64url.stringify(c,{pad:!1})}async function g(a,b,c){if(!c.algorithm)throw Error("No algorithm specified");let g=new TextEncoder,h=(0,d.getCryptoAlgorithm)(c.algorithm);if(!h)return{errors:[new e.SignJWTError(`Unsupported algorithm ${c.algorithm}`)]};let i=await (0,d.importKey)(b,h,"sign"),j=c.header||{typ:"JWT"};j.alg=c.algorithm,a.iat=Math.floor(Date.now()/1e3);let k=f(j),l=f(a),m=`${k}.${l}`;try{let a=await d.runtime.crypto.subtle.sign(h,i,g.encode(m));return{data:`${m}.${d.base64url.stringify(new Uint8Array(a),{pad:!1})}`}}catch(a){return{errors:[new e.SignJWTError(a?.message)]}}}a.i(35490),(0,c.withLegacyReturn)(d.verifyJwt);var h=(0,c.withLegacySyncReturn)(d.decodeJwt);(0,c.withLegacyReturn)(g),(0,c.withLegacyReturn)(d.hasValidSignature);var i=a.i(39639),j=a.i(12175),k=a.i(17898);let l=a=>({authStatus:(0,j.getAuthKeyFromRequest)(a,"AuthStatus"),authToken:(0,j.getAuthKeyFromRequest)(a,"AuthToken"),authMessage:(0,j.getAuthKeyFromRequest)(a,"AuthMessage"),authReason:(0,j.getAuthKeyFromRequest)(a,"AuthReason"),authSignature:(0,j.getAuthKeyFromRequest)(a,"AuthSignature")}),m=(a,c,d=!0)=>{let e=(0,j.getHeader)(a,b.constants.Headers.ClerkRequestData),f=(0,k.decryptClerkRequestData)(e);return{secretKey:(null==c?void 0:c.secretKey)||f.secretKey||i.SECRET_KEY,publishableKey:f.publishableKey||i.PUBLISHABLE_KEY,apiUrl:i.API_URL,apiVersion:i.API_VERSION,authStatus:(0,j.getAuthKeyFromRequest)(a,"AuthStatus"),authMessage:(0,j.getAuthKeyFromRequest)(a,"AuthMessage"),authReason:(0,j.getAuthKeyFromRequest)(a,"AuthReason"),treatPendingAsSignedOut:d}},n=(a,{treatPendingAsSignedOut:c=!0,...d}={})=>{var e,f;let{authStatus:g,authMessage:i,authReason:j,authToken:n,authSignature:o}=l(a);null==(e=d.logger)||e.debug("headers",{authStatus:g,authMessage:i,authReason:j});let p=m(a,d,c);if(!(0,b.isTokenTypeAccepted)(b.TokenType.SessionToken,d.acceptsToken||b.TokenType.SessionToken))return(0,b.signedOutAuthObject)(p);if(g&&g===b.AuthStatus.SignedIn){(0,k.assertTokenSignature)(n,p.secretKey,o);let a=h(n);return null==(f=d.logger)||f.debug("jwt",a.raw),(0,b.getAuthObjectFromJwt)(a,p)}return(0,b.signedOutAuthObject)(p)},o=(a,c={})=>{var d,e;let{authStatus:f,authMessage:g,authReason:h}=l(a);null==(d=c.logger)||d.debug("headers",{authStatus:f,authMessage:g,authReason:h});let i=(0,j.getHeader)(a,b.constants.Headers.ClerkRequestData),o=(0,k.decryptClerkRequestData)(i),q=null==(e=(0,j.getHeader)(a,b.constants.Headers.Authorization))?void 0:e.replace("Bearer ",""),r=c.acceptsToken||b.TokenType.SessionToken,s=m(a,c),t=p(q,o.machineAuthObject,r,s);return t||(q&&Array.isArray(r)&&!r.includes(b.TokenType.SessionToken)?(0,b.invalidTokenAuthObject)():n(a,c))},p=(a,c,d,e)=>{let f=a&&(0,b.isMachineTokenByPrefix)(a),g=d===b.TokenType.SessionToken||Array.isArray(d)&&1===d.length&&d[0]===b.TokenType.SessionToken;if(f&&c&&!g){let f=(0,b.getAuthObjectForAcceptedToken)({authObject:{...c,debug:()=>e},acceptsToken:d});return{...f,getToken:()=>f.isAuthenticated?Promise.resolve(a):Promise.resolve(null),has:()=>!1}}return null};a.s(["getAuthDataFromRequest",()=>o,"getSessionAuthDataFromRequest",()=>n],54609)},26977,a=>{"use strict";var b=a.i(30484);let c=a=>{if(!a||"string"!=typeof a)return a;try{return(a||"").replace(/^(sk_(live|test)_)(.+?)(.{3})$/,"$1*********$4")}catch{return""}},d=a=>(Array.isArray(a)?a:[a]).map(a=>"string"==typeof a?c(a):JSON.stringify(Object.fromEntries(Object.entries(a).map(([a,b])=>[a,c(b)])),null,2)).join(", "),e=(a,c)=>(...e)=>{let f=("string"==typeof a?()=>{let c=[],e=!1;return{enable:()=>{e=!0},debug:(...a)=>{e&&c.push(a.map(a=>"function"==typeof a?a():a))},commit:()=>{if(e){var f,g;for(let b of(console.log((f=a,`[clerk debug start: ${f}]`)),c)){let a=d(b);a=a.split("\n").map(a=>`  ${a}`).join("\n"),process.env.VERCEL&&(a=function(a,b){let c=new TextEncoder,d=new TextDecoder("utf-8"),e=c.encode(a).slice(0,4096);return d.decode(e).replace(/\uFFFD/g,"")}(a,4096)),console.log(a)}console.log((g=a,`[clerk debug end: ${g}] (@clerk/nextjs=6.36.2,next=${b.default.version},timestamp=${Math.round(new Date().getTime()/1e3)})`))}}}}:a)(),g=c(f);try{let a=g(...e);if("object"==typeof a&&"then"in a&&"function"==typeof a.then)return a.then(a=>(f.commit(),a)).catch(a=>{throw f.commit(),a});return f.commit(),a}catch(a){throw f.commit(),a}};a.s(["withLogger",()=>e],26977)},21705,a=>{"use strict";a.i(9868);var b=a.i(26847);a.i(33942);var c=a.i(34e3),d=a.i(39639);a.i(52824);var e=a.i(29154),f=a.i(26977),g=a.i(61961),h=a.i(54609),i=a.i(32987),j=a.i(12175),k=a.i(17898);(({debugLoggerName:a,noAuthStatusMessage:c})=>(0,f.withLogger)(a,a=>(d,f)=>((0,e.isTruthy)((0,j.getHeader)(d,b.constants.Headers.EnableDebug))&&a.enable(),(0,k.assertAuthStatus)(d,c),((b,c={})=>(0,h.getSessionAuthDataFromRequest)(b,{...c,logger:a,acceptsToken:null==c?void 0:c.acceptsToken}))(d,{...f,logger:a,acceptsToken:null==f?void 0:f.acceptsToken}))))({debugLoggerName:"getAuth()",noAuthStatusMessage:(0,i.getAuthAuthHeaderMissing)()});let l={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401};Object.values(l);let m="NEXT_HTTP_ERROR_FALLBACK";function n(){let a=Error(m);throw a.digest=`${m};${l.UNAUTHORIZED}`,a}var o=a.i(25879);let p=a=>{var c,d;return!!a.headers.get(o.constants.Headers.NextUrl)&&!(a.headers.get(o.constants.Headers.NextUrl)&&((null==(c=a.headers.get(b.constants.Headers.Accept))?void 0:c.includes("text/x-component"))||(null==(d=a.headers.get(b.constants.Headers.ContentType))?void 0:d.includes("multipart/form-data"))||a.headers.get(o.constants.Headers.NextAction)))||q()},q=()=>{let a=globalThis.fetch;if(!("__nextPatched"in a&&!0===a.__nextPatched))return!1;let{page:b,pagePath:c}=a.__nextGetStaticStore().getStore()||{};return!!(c||b)},r=a=>!!a.headers.get(o.constants.Headers.NextjsData);var s=a.i(57729);let t=async l=>{var m;a.r(10534);let n=await (0,s.buildRequestLike)(),o=async()=>{if(g.isNextWithUnstableServerActions)return[];try{let b=await a.A(28889).then(a=>a.hasSrcAppDir());return[`Your Middleware exists at ./${b?"src/":""}middleware.(ts|js)`]}catch{return[]}},p=await (({debugLoggerName:c,noAuthStatusMessage:d})=>(0,f.withLogger)(c,c=>async(f,i)=>{if((0,e.isTruthy)((0,j.getHeader)(f,b.constants.Headers.EnableDebug))&&c.enable(),!(0,j.detectClerkMiddleware)(f)){g.isNextWithUnstableServerActions&&(0,k.assertAuthStatus)(f,d);let b=await a.A(28889).then(a=>a.suggestMiddlewareLocation()).catch(()=>void 0);if(b)throw Error(b);(0,k.assertAuthStatus)(f,d)}return((a,b={})=>(0,h.getAuthDataFromRequest)(a,{...b,logger:c,acceptsToken:null==b?void 0:b.acceptsToken}))(f,{...i,logger:c,acceptsToken:null==i?void 0:i.acceptsToken})}))({debugLoggerName:"auth()",noAuthStatusMessage:(0,i.authAuthHeaderMissing)("auth",await o())})(n,{treatPendingAsSignedOut:null==l?void 0:l.treatPendingAsSignedOut,acceptsToken:null!=(m=null==l?void 0:l.acceptsToken)?m:b.TokenType.SessionToken}),q=(0,j.getAuthKeyFromRequest)(n,"ClerkUrl"),r=(...a)=>{let{returnBackUrl:e}=a[0]||{},f=(0,b.createClerkRequest)(n),g=f.clerkUrl.searchParams.get(b.constants.QueryParameters.DevBrowser)||f.cookies.get(b.constants.Cookies.DevBrowser),h=(0,j.getHeader)(n,b.constants.Headers.ClerkRequestData),i=(0,k.decryptClerkRequestData)(h);return[(0,b.createRedirect)({redirectAdapter:c.redirect,devBrowserToken:g,baseUrl:f.clerkUrl.toString(),publishableKey:i.publishableKey||d.PUBLISHABLE_KEY,signInUrl:i.signInUrl||d.SIGN_IN_URL,signUpUrl:i.signUpUrl||d.SIGN_UP_URL,sessionStatus:p.tokenType===b.TokenType.SessionToken?p.sessionStatus:null}),null===e?"":e||(null==q?void 0:q.toString())]};return p.tokenType===b.TokenType.SessionToken?Object.assign(p,{redirectToSignIn:(a={})=>{let[b,c]=r(a);return b.redirectToSignIn({returnBackUrl:c})},redirectToSignUp:(a={})=>{let[b,c]=r(a);return b.redirectToSignUp({returnBackUrl:c})}}):p};t.protect=async(...d)=>{var e,f;a.r(10534);let g=await (0,s.buildRequestLike)(),h=(null==(e=null==d?void 0:d[0])?void 0:e.token)||(null==(f=null==d?void 0:d[1])?void 0:f.token)||b.TokenType.SessionToken,i=await t({acceptsToken:h});return(function(a){let{redirectToSignIn:c,authObject:d,redirect:e,notFound:f,request:g,unauthorized:h}=a;return async(...a)=>{var i,j,k,l,m,n,o,q;let s=(a=>{if(a&&!a.unauthenticatedUrl&&!a.unauthorizedUrl&&!a.token&&(1!==Object.keys(a).length||!("token"in a)))return a})(a[0]),t=(null==(i=a[0])?void 0:i.unauthenticatedUrl)||(null==(j=a[1])?void 0:j.unauthenticatedUrl),u=(null==(k=a[0])?void 0:k.unauthorizedUrl)||(null==(l=a[1])?void 0:l.unauthorizedUrl),v=(null==(m=a[0])?void 0:m.token)||(null==(n=a[1])?void 0:n.token)||b.TokenType.SessionToken,w=()=>d.tokenType!==b.TokenType.SessionToken?h():u?e(u):f();if(!(0,b.isTokenTypeAccepted)(d.tokenType,v))return w();if(d.tokenType!==b.TokenType.SessionToken)return d.isAuthenticated?d:w();if("pending"===d.sessionStatus||!d.userId){return t?e(t):"document"===(o=g).headers.get(b.constants.Headers.SecFetchDest)||"iframe"===o.headers.get(b.constants.Headers.SecFetchDest)||(null==(q=o.headers.get(b.constants.Headers.Accept))?void 0:q.includes("text/html"))||p(o)||r(o)?c():f()}return s?"function"==typeof s?s(d.has)?d:w():d.has(s)?d:w():d}})({request:g,authObject:i,redirectToSignIn:i.redirectToSignIn,notFound:c.notFound,redirect:c.redirect,unauthorized:n})(...d)},a.s(["auth",()=>t],21705)}];

//# sourceMappingURL=9f905_%40clerk_nextjs_dist_esm_fabb74be._.js.map