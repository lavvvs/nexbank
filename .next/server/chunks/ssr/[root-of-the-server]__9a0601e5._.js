module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70864,a=>{a.n(a.i(33290))},6979,a=>{a.n(a.i(7978))},49140,a=>{a.n(a.i(11560))},37087,a=>{a.n(a.i(275))},60214,a=>{a.n(a.i(38227))},70809,a=>{a.n(a.i(3605))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},27699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},21517,(a,b,c)=>{b.exports=a.x("http",()=>require("http"))},24836,(a,b,c)=>{b.exports=a.x("https",()=>require("https"))},33405,(a,b,c)=>{b.exports=a.x("child_process",()=>require("child_process"))},7394,a=>{"use strict";var b=a.i(85224),c=a.i(21705),d=a.i(27071),e=a.i(22017),f=a.i(13761),g=a.i(26046);async function h(a){try{let h=await (0,c.auth)();if(!h.userId)return b.NextResponse.json({error:"Unauthorized"},{status:401});let{sessionId:i}=await a.json();if(!i)return b.NextResponse.json({error:"Session ID required"},{status:400});console.log("ðŸ” Confirming payment for session:",i);let j=await d.stripe.checkout.sessions.retrieve(i);if(console.log("ðŸ“Š Session details:",{id:j.id,payment_status:j.payment_status,metadata:j.metadata}),"paid"!==j.payment_status)return b.NextResponse.json({error:"Payment not completed",status:j.payment_status},{status:400});let k=j.metadata?.accountId,l=j.amount_total?j.amount_total/100:0;if(!k)return b.NextResponse.json({error:"Missing account ID in session metadata"},{status:400});if(await (0,e.default)(),!g.default.Types.ObjectId.isValid(k))return b.NextResponse.json({error:"Invalid account ID"},{status:400});let m=await f.Account.findOneAndUpdate({_id:k,userId:h.userId},{$inc:{balance:l}},{new:!0,runValidators:!0});if(!m)return b.NextResponse.json({error:"Account not found or unauthorized"},{status:404});return console.log("âœ… Balance updated successfully:",{accountId:m._id.toString(),newBalance:m.balance,addedAmount:l}),b.NextResponse.json({success:!0,newBalance:m.balance,depositAmount:l})}catch(a){return console.error("âŒ Error confirming deposit:",a),b.NextResponse.json({error:"Failed to confirm deposit"},{status:500})}}a.s(["POST",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__9a0601e5._.js.map