module.exports=[5522,a=>{"use strict";var b=a.i(46447),c=a.i(97895);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,"data-slot":"input",className:(0,c.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...e})}a.s(["Input",()=>d])},84435,a=>{"use strict";let b=(0,a.i(61237).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],84435)},17171,a=>{"use strict";var b=a.i(46447),c=a.i(30564),d=a.i(87695),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(97895);function g({className:a,...c}){return(0,b.jsx)(e,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...c})}a.s(["Label",()=>g],17171)},74897,a=>{"use strict";function b(a,b,c){let d=b/12/100;return 0===d?a/c:Math.round(a*d*Math.pow(1+d,c)/(Math.pow(1+d,c)-1)*100)/100}function c(a,b="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:b}).format(a)}a.s(["calculateEMI",()=>b,"formatCurrency",()=>c])},65733,a=>{"use strict";var b=a.i(46447),c=a.i(98043),d=a.i(33955),e=a.i(97895);function f({...a}){return(0,b.jsx)(c.Root,{"data-slot":"dialog",...a})}function g({...a}){return(0,b.jsx)(c.Trigger,{"data-slot":"dialog-trigger",...a})}function h({...a}){return(0,b.jsx)(c.Portal,{"data-slot":"dialog-portal",...a})}function i({className:a,...d}){return(0,b.jsx)(c.Overlay,{"data-slot":"dialog-overlay",className:(0,e.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...d})}function j({className:a,children:f,showCloseButton:g=!0,...j}){return(0,b.jsxs)(h,{"data-slot":"dialog-portal",children:[(0,b.jsx)(i,{}),(0,b.jsxs)(c.Content,{"data-slot":"dialog-content",className:(0,e.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...j,children:[f,g&&(0,b.jsxs)(c.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,b.jsx)(d.XIcon,{}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function k({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-header",className:(0,e.cn)("flex flex-col gap-2 text-center sm:text-left",a),...c})}function l({className:a,...d}){return(0,b.jsx)(c.Title,{"data-slot":"dialog-title",className:(0,e.cn)("text-lg leading-none font-semibold",a),...d})}function m({className:a,...d}){return(0,b.jsx)(c.Description,{"data-slot":"dialog-description",className:(0,e.cn)("text-muted-foreground text-sm",a),...d})}a.s(["Dialog",()=>f,"DialogContent",()=>j,"DialogDescription",()=>m,"DialogHeader",()=>k,"DialogTitle",()=>l,"DialogTrigger",()=>g])},46893,a=>{"use strict";var b=a.i(46447),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...d})}a.s(["Textarea",()=>d])},47779,a=>{"use strict";var b=a.i(46447),c=a.i(30564),d=a.i(1470),e=a.i(40695),f=a.i(65733),g=a.i(87682),h=a.i(5522),i=a.i(17171),j=a.i(46893),k=a.i(74897),l=a.i(84435);function m({open:a,onOpenChange:m,accounts:n,userId:o,onWithdrawSuccess:p,createTransaction:q,updateAccountBalance:r}){let[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),C=(0,d.useRouter)(),D=n.find(a=>a.id===s),E=()=>{t(""),v(""),x(""),B(null)},F=async()=>{if(!s||!u)return void B("Please fill in all required fields");let a=Number.parseFloat(u);if(isNaN(a)||a<=0)return void B("Please enter a valid amount");if(D&&a>D.balance)return void B("Insufficient balance");z(!0),B(null);try{let b=`WTH-${Date.now()}`;if(!D)throw Error("Account not found");await q({userId:o,accountId:D.id,amount:a,type:"withdrawal",description:w||"Withdrawal",referenceId:b});let c=D.balance-a;await r(D.id,c),m(!1),E(),p&&p(),C.refresh()}catch(a){console.error("Withdrawal error:",a),B(a.message||"Withdrawal failed. Please try again.")}finally{z(!1)}};return(0,b.jsx)(f.Dialog,{open:a,onOpenChange:a=>{m(a),a||E()},children:(0,b.jsxs)(f.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"Withdraw Money"}),(0,b.jsx)(f.DialogDescription,{children:"Withdraw funds from your account."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Select Account"}),(0,b.jsxs)(g.Select,{value:s,onValueChange:t,children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Choose account"})}),(0,b.jsx)(g.SelectContent,{children:n.map(a=>(0,b.jsx)(g.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsx)("span",{className:"capitalize",children:a.accountType}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,k.formatCurrency)(a.balance)})]})},a.id))})]}),D&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Available balance: ",(0,k.formatCurrency)(D.balance)]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Amount (USD)"}),(0,b.jsx)(h.Input,{type:"number",placeholder:"0.00",value:u,onChange:a=>v(a.target.value),min:"0",step:"0.01"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Description (Optional)"}),(0,b.jsx)(j.Textarea,{placeholder:"Add a note...",value:w,onChange:a=>x(a.target.value),rows:2})]}),A&&(0,b.jsx)("div",{className:"rounded-lg bg-destructive/10 p-3 text-sm text-destructive",children:A})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:F,disabled:y,variant:"destructive",children:y?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}):"Withdraw"})]})]})})}function n({accounts:a,userId:d}){let[e,f]=(0,c.useState)(!1),g=async a=>{let b=await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).error||"Failed to create transaction");return b.json()},h=async(a,b)=>{try{let c=await fetch(`/api/accounts/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({balance:b})});if(!c.ok){let a=await c.json();throw console.error("Balance update failed:",a),Error(a.error||"Failed to update balance")}return await c.json()}catch(a){throw console.error("Error updating balance:",a),a}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{className:"px-4 py-2 rounded bg-accent text-white hover:bg-accent/80",onClick:()=>f(!0),children:"Withdraw"}),(0,b.jsx)(m,{accounts:a,userId:d,open:e,onOpenChange:f,createTransaction:g,updateAccountBalance:h})]})}a.s(["WithdrawDialogWrapper",()=>n],47779)}];

//# sourceMappingURL=_b1c8ccdf._.js.map